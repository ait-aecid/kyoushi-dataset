
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="IDS Dataset processing and labeling tool.">
      
      
      
      
        <link rel="canonical" href="https://ait-aecid.github.io/kyoushi-dataset/reference/processors/">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-6.2.8">
    
    
      
        <title>Processors - Cyber Range Kyoushi Dataset</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/jquery.fancybox.min.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="ait" data-md-color-primary="" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#processors-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://ait-aecid.github.io/kyoushi-dataset/" title="Cyber Range Kyoushi Dataset" class="md-header-nav__button md-logo" aria-label="Cyber Range Kyoushi Dataset">
      
  <img src="../../images/cr_icon.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Cyber Range Kyoushi Dataset
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Processors
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ait-aecid/kyoushi-dataset/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kyoushi-dataset
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ait-aecid.github.io/kyoushi-dataset/" title="Cyber Range Kyoushi Dataset" class="md-nav__button md-logo" aria-label="Cyber Range Kyoushi Dataset">
      
  <img src="../../images/cr_icon.svg" alt="logo">

    </a>
    Cyber Range Kyoushi Dataset
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ait-aecid/kyoushi-dataset/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kyoushi-dataset
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/intro/" class="md-nav__link">
        Intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/prepare/" class="md-nav__link">
        Prepare Dataset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/process/" class="md-nav__link">
        Process Dataset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/label/" class="md-nav__link">
        Label Dataset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/sample/" class="md-nav__link">
        Sample Labels
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/process/" class="md-nav__link">
        Dataset Processing
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../processors/" class="md-nav__link">
        Dataset Processors
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../rules/" class="md-nav__link">
        Labeling Rules
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        CLI Reference
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
      
      <label class="md-nav__link" for="nav-7">
        Code Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Code Reference" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        Config
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../elasticsearch/" class="md-nav__link">
        Elasticsearch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../labels/" class="md-nav__link">
        Labels
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../parser/" class="md-nav__link">
        Parser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../pcap/" class="md-nav__link">
        PCAP Utilities
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Processors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Processors
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors" class="md-nav__link">
    cr_kyoushi.dataset.processors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorList" class="md-nav__link">
    ProcessorList
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor" class="md-nav__link">
    ComponentTemplateCreateProcessor
  </a>
  
    <nav class="md-nav" aria-label="ComponentTemplateCreateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.create_only" class="md-nav__link">
    create_only
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template" class="md-nav__link">
    template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template_name" class="md-nav__link">
    template_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor" class="md-nav__link">
    CreateDirectoryProcessor
  </a>
  
    <nav class="md-nav" aria-label="CreateDirectoryProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.path" class="md-nav__link">
    path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.recursive" class="md-nav__link">
    recursive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor" class="md-nav__link">
    ForEachProcessor
  </a>
  
    <nav class="md-nav" aria-label="ForEachProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.items" class="md-nav__link">
    items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.loop_var" class="md-nav__link">
    loop_var
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.processor" class="md-nav__link">
    processor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.processors" class="md-nav__link">
    processors()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor" class="md-nav__link">
    GzipProcessor
  </a>
  
    <nav class="md-nav" aria-label="GzipProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.glob" class="md-nav__link">
    glob
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.path" class="md-nav__link">
    path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor" class="md-nav__link">
    IngestCreateProcessor
  </a>
  
    <nav class="md-nav" aria-label="IngestCreateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline" class="md-nav__link">
    ingest_pipeline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline_id" class="md-nav__link">
    ingest_pipeline_id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor" class="md-nav__link">
    LegacyTemplateCreateProcessor
  </a>
  
    <nav class="md-nav" aria-label="LegacyTemplateCreateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.create_only" class="md-nav__link">
    create_only
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.index_patterns" class="md-nav__link">
    index_patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.indices_prefix_dataset" class="md-nav__link">
    indices_prefix_dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.order" class="md-nav__link">
    order
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template" class="md-nav__link">
    template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template_name" class="md-nav__link">
    template_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor" class="md-nav__link">
    LogstashSetupProcessor
  </a>
  
    <nav class="md-nav" aria-label="LogstashSetupProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.index_template_template" class="md-nav__link">
    index_template_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_config_name" class="md-nav__link">
    input_config_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_template" class="md-nav__link">
    input_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.legacy_index_template_template" class="md-nav__link">
    legacy_index_template_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.logstash_template" class="md-nav__link">
    logstash_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_config_name" class="md-nav__link">
    output_config_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_template" class="md-nav__link">
    output_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.piplines_template" class="md-nav__link">
    piplines_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_name" class="md-nav__link">
    pre_process_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_template" class="md-nav__link">
    pre_process_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.servers" class="md-nav__link">
    servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.use_legacy_template" class="md-nav__link">
    use_legacy_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.default_server_timezone" class="md-nav__link">
    default_server_timezone()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.validate_servers" class="md-nav__link">
    validate_servers()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor" class="md-nav__link">
    PcapElasticsearchProcessor
  </a>
  
    <nav class="md-nav" aria-label="PcapElasticsearchProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.create_destination_dirs" class="md-nav__link">
    create_destination_dirs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.dest" class="md-nav__link">
    dest
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.force" class="md-nav__link">
    force
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_details" class="md-nav__link">
    packet_details
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_summary" class="md-nav__link">
    packet_summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.pcap" class="md-nav__link">
    pcap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter" class="md-nav__link">
    protocol_match_filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter_parent" class="md-nav__link">
    protocol_match_filter_parent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.read_filter" class="md-nav__link">
    read_filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_filtered" class="md-nav__link">
    remove_filtered
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_index_messages" class="md-nav__link">
    remove_index_messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tls_keylog" class="md-nav__link">
    tls_keylog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tshark_bin" class="md-nav__link">
    tshark_bin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor" class="md-nav__link">
    PrintProcessor
  </a>
  
    <nav class="md-nav" aria-label="PrintProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.msg" class="md-nav__link">
    msg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.Processor" class="md-nav__link">
    Processor
  </a>
  
    <nav class="md-nav" aria-label="Processor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.Processor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.Processor.render" class="md-nav__link">
    render()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase" class="md-nav__link">
    ProcessorBase
  </a>
  
    <nav class="md-nav" aria-label="ProcessorBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.render" class="md-nav__link">
    render()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContainer" class="md-nav__link">
    ProcessorContainer
  </a>
  
    <nav class="md-nav" aria-label="ProcessorContainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContainer.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContainer.processors" class="md-nav__link">
    processors()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContext" class="md-nav__link">
    ProcessorContext
  </a>
  
    <nav class="md-nav" aria-label="ProcessorContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContext.variable_files" class="md-nav__link">
    variable_files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContext.variables" class="md-nav__link">
    variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContext.load" class="md-nav__link">
    load()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorPipeline" class="md-nav__link">
    ProcessorPipeline
  </a>
  
    <nav class="md-nav" aria-label="ProcessorPipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorPipeline.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorPipeline.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor" class="md-nav__link">
    TemplateCreateProcessor
  </a>
  
    <nav class="md-nav" aria-label="TemplateCreateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.composed_of" class="md-nav__link">
    composed_of
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.create_only" class="md-nav__link">
    create_only
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.index_patterns" class="md-nav__link">
    index_patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.indices_prefix_dataset" class="md-nav__link">
    indices_prefix_dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.priority" class="md-nav__link">
    priority
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.template" class="md-nav__link">
    template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.template_name" class="md-nav__link">
    template_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor" class="md-nav__link">
    TemplateProcessor
  </a>
  
    <nav class="md-nav" aria-label="TemplateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.dest" class="md-nav__link">
    dest
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.src" class="md-nav__link">
    src
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.template_context" class="md-nav__link">
    template_context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor" class="md-nav__link">
    TrimProcessor
  </a>
  
    <nav class="md-nav" aria-label="TrimProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.end" class="md-nav__link">
    end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.exclude" class="md-nav__link">
    exclude
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.indices" class="md-nav__link">
    indices
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.indices_prefix_dataset" class="md-nav__link">
    indices_prefix_dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.start" class="md-nav__link">
    start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.get_doc_stats" class="md-nav__link">
    get_doc_stats()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.get_line_stats" class="md-nav__link">
    get_line_stats()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sample/" class="md-nav__link">
        Sampling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../templates/" class="md-nav__link">
        Templates
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Utility Functions
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors" class="md-nav__link">
    cr_kyoushi.dataset.processors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorList" class="md-nav__link">
    ProcessorList
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor" class="md-nav__link">
    ComponentTemplateCreateProcessor
  </a>
  
    <nav class="md-nav" aria-label="ComponentTemplateCreateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.create_only" class="md-nav__link">
    create_only
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template" class="md-nav__link">
    template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template_name" class="md-nav__link">
    template_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor" class="md-nav__link">
    CreateDirectoryProcessor
  </a>
  
    <nav class="md-nav" aria-label="CreateDirectoryProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.path" class="md-nav__link">
    path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.recursive" class="md-nav__link">
    recursive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor" class="md-nav__link">
    ForEachProcessor
  </a>
  
    <nav class="md-nav" aria-label="ForEachProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.items" class="md-nav__link">
    items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.loop_var" class="md-nav__link">
    loop_var
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.processor" class="md-nav__link">
    processor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ForEachProcessor.processors" class="md-nav__link">
    processors()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor" class="md-nav__link">
    GzipProcessor
  </a>
  
    <nav class="md-nav" aria-label="GzipProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.glob" class="md-nav__link">
    glob
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.path" class="md-nav__link">
    path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.GzipProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor" class="md-nav__link">
    IngestCreateProcessor
  </a>
  
    <nav class="md-nav" aria-label="IngestCreateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline" class="md-nav__link">
    ingest_pipeline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline_id" class="md-nav__link">
    ingest_pipeline_id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor" class="md-nav__link">
    LegacyTemplateCreateProcessor
  </a>
  
    <nav class="md-nav" aria-label="LegacyTemplateCreateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.create_only" class="md-nav__link">
    create_only
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.index_patterns" class="md-nav__link">
    index_patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.indices_prefix_dataset" class="md-nav__link">
    indices_prefix_dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.order" class="md-nav__link">
    order
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template" class="md-nav__link">
    template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template_name" class="md-nav__link">
    template_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor" class="md-nav__link">
    LogstashSetupProcessor
  </a>
  
    <nav class="md-nav" aria-label="LogstashSetupProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.index_template_template" class="md-nav__link">
    index_template_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_config_name" class="md-nav__link">
    input_config_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_template" class="md-nav__link">
    input_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.legacy_index_template_template" class="md-nav__link">
    legacy_index_template_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.logstash_template" class="md-nav__link">
    logstash_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_config_name" class="md-nav__link">
    output_config_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_template" class="md-nav__link">
    output_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.piplines_template" class="md-nav__link">
    piplines_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_name" class="md-nav__link">
    pre_process_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_template" class="md-nav__link">
    pre_process_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.servers" class="md-nav__link">
    servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.use_legacy_template" class="md-nav__link">
    use_legacy_template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.default_server_timezone" class="md-nav__link">
    default_server_timezone()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.validate_servers" class="md-nav__link">
    validate_servers()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor" class="md-nav__link">
    PcapElasticsearchProcessor
  </a>
  
    <nav class="md-nav" aria-label="PcapElasticsearchProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.create_destination_dirs" class="md-nav__link">
    create_destination_dirs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.dest" class="md-nav__link">
    dest
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.force" class="md-nav__link">
    force
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_details" class="md-nav__link">
    packet_details
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_summary" class="md-nav__link">
    packet_summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.pcap" class="md-nav__link">
    pcap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter" class="md-nav__link">
    protocol_match_filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter_parent" class="md-nav__link">
    protocol_match_filter_parent
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.read_filter" class="md-nav__link">
    read_filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_filtered" class="md-nav__link">
    remove_filtered
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_index_messages" class="md-nav__link">
    remove_index_messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tls_keylog" class="md-nav__link">
    tls_keylog
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tshark_bin" class="md-nav__link">
    tshark_bin
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor" class="md-nav__link">
    PrintProcessor
  </a>
  
    <nav class="md-nav" aria-label="PrintProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.msg" class="md-nav__link">
    msg
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.PrintProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.Processor" class="md-nav__link">
    Processor
  </a>
  
    <nav class="md-nav" aria-label="Processor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.Processor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.Processor.render" class="md-nav__link">
    render()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase" class="md-nav__link">
    ProcessorBase
  </a>
  
    <nav class="md-nav" aria-label="ProcessorBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorBase.render" class="md-nav__link">
    render()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContainer" class="md-nav__link">
    ProcessorContainer
  </a>
  
    <nav class="md-nav" aria-label="ProcessorContainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContainer.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContainer.processors" class="md-nav__link">
    processors()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContext" class="md-nav__link">
    ProcessorContext
  </a>
  
    <nav class="md-nav" aria-label="ProcessorContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContext.variable_files" class="md-nav__link">
    variable_files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContext.variables" class="md-nav__link">
    variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorContext.load" class="md-nav__link">
    load()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorPipeline" class="md-nav__link">
    ProcessorPipeline
  </a>
  
    <nav class="md-nav" aria-label="ProcessorPipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorPipeline.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.ProcessorPipeline.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor" class="md-nav__link">
    TemplateCreateProcessor
  </a>
  
    <nav class="md-nav" aria-label="TemplateCreateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.composed_of" class="md-nav__link">
    composed_of
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.create_only" class="md-nav__link">
    create_only
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.index_patterns" class="md-nav__link">
    index_patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.indices_prefix_dataset" class="md-nav__link">
    indices_prefix_dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.priority" class="md-nav__link">
    priority
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.template" class="md-nav__link">
    template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.template_name" class="md-nav__link">
    template_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor" class="md-nav__link">
    TemplateProcessor
  </a>
  
    <nav class="md-nav" aria-label="TemplateProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.dest" class="md-nav__link">
    dest
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.src" class="md-nav__link">
    src
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.template_context" class="md-nav__link">
    template_context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TemplateProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor" class="md-nav__link">
    TrimProcessor
  </a>
  
    <nav class="md-nav" aria-label="TrimProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.context" class="md-nav__link">
    context
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.end" class="md-nav__link">
    end
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.exclude" class="md-nav__link">
    exclude
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.indices" class="md-nav__link">
    indices
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.indices_prefix_dataset" class="md-nav__link">
    indices_prefix_dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.start" class="md-nav__link">
    start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.type_field" class="md-nav__link">
    type_field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.execute" class="md-nav__link">
    execute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.get_doc_stats" class="md-nav__link">
    get_doc_stats()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cr_kyoushi.dataset.processors.TrimProcessor.get_line_stats" class="md-nav__link">
    get_line_stats()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ait-aecid/kyoushi-dataset/edit/main/docs/reference/processors.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="processors-module">Processors module<a class="headerlink" href="#processors-module" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="cr_kyoushi.dataset.processors"></a>
    <div class="doc doc-contents first">

      <p>This module contains the base definitions of dataset pipeline processors and also
the core processors shipped with the Cyber Range Kyoushi Dataset package.</p>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorList">
<code class="highlight language-python"><span class="n">ProcessorList</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorList" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Type alias for a list of processors</p>
    </div>

  </div>




  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor">
        <code>
ComponentTemplateCreateProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor for creating Elasticsearch index component templates.</p>
<p>This processor can be used to create Elasticsearch
index component templates. To prepare the Elasticsearch instance
for the parsing phase. See the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-templates.html">index templates doc</a>
for more details.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add pcap component template</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticsearch.component_template</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/logstash/pcap-component-template.json</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.create_only">
<code class="highlight language-python"><span class="n">create_only</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.create_only" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If true then an existing template with the given name will not be replaced.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template">
<code class="highlight language-python"><span class="n">template</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The index component template to add to elasticsearch</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template_name">
<code class="highlight language-python"><span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template_name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The name to use for the index component template</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Execute the processor and configure Elasticsearch index component template.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute the processor and configure Elasticsearch index component template.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">template_data</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>

    <span class="n">ies</span> <span class="o">=</span> <span class="n">ClusterClient</span><span class="p">(</span><span class="n">es</span><span class="p">)</span>

    <span class="n">ies</span><span class="o">.</span><span class="n">put_component_template</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">template_name</span><span class="p">,</span>
        <span class="n">body</span><span class="o">=</span><span class="n">template_data</span><span class="p">,</span>
        <span class="n">create</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_only</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.CreateDirectoryProcessor">
        <code>
CreateDirectoryProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor for creating file directories.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensure processing config directory exists</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mkdir</span><span class="w"></span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.CreateDirectoryProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.CreateDirectoryProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.CreateDirectoryProcessor.path">
<code class="highlight language-python"><span class="n">path</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.path" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The directory path to create</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.CreateDirectoryProcessor.recursive">
<code class="highlight language-python"><span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.recursive" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If all missing parent directories should als be created</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.CreateDirectoryProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.CreateDirectoryProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Execute the processor and create the directory.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute the processor and create the directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor">
        <code>
ForEachProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>For each processor</p>
<p>This is a special processor container allowing for the
dynamic creation of a list of processor based on a list
of items.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Render labeling rules</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreach</span><span class="w"></span>
<span class="w">  </span><span class="c1"># processing/templates/rules</span><span class="w"></span>
<span class="w">  </span><span class="nt">items</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0_auth.yaml.j2</span><span class="w"></span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0_auth.yaml</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apache.yaml.j2</span><span class="w"></span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apache.yaml</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">audit.yaml.j2</span><span class="w"></span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">audit.yaml</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openvpn.yaml.j2</span><span class="w"></span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openvpn.yaml</span><span class="w"></span>
<span class="w">  </span><span class="nt">processor</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span><span class="w"></span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Rendering labeling rule {{ item.src }}</span><span class="w"></span>
<span class="w">    </span><span class="nt">template_context</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">var_files</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">attacker</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/attacker.yaml</span><span class="w"></span>
<span class="w">        </span><span class="nt">escalate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/escalate.yaml</span><span class="w"></span>
<span class="w">        </span><span class="nt">foothold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/foothold.yaml</span><span class="w"></span>
<span class="w">        </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/servers.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;processing/templates/rules/{{</span><span class="nv"> </span><span class="s">item.src</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;rules/{{</span><span class="nv"> </span><span class="s">item.dest</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.items">
<code class="highlight language-python"><span class="n">items</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.items" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>List of items to create processors for</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.loop_var">
<code class="highlight language-python"><span class="n">loop_var</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.loop_var" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable name to use for current loops item in the processor context</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.processor">
<code class="highlight language-python"><span class="n">processor</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.processor" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor template config to create multiple instances of</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Executes the processor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Executes the processor.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Incomplete processor implementation!&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.processors">
<code class="highlight language-python"><span class="n">processors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.processors" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Create a list of processors for each item.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Dict[str, Any]]</code></td>
      <td><p>List of processors based on the given items and
processor template.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">processors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Create a list of processors for each item.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of processors based on the given items and</span>
<span class="sd">        processor template.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">processors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="n">processor</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processor</span><span class="p">)</span>
        <span class="c1"># set the loop var</span>
        <span class="k">if</span> <span class="s2">&quot;context&quot;</span> <span class="ow">in</span> <span class="n">processor</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">processor</span><span class="p">[</span><span class="s2">&quot;context&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
            <span class="n">processor</span><span class="p">[</span><span class="s2">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">variables</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;vars&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">variables</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">loop_var</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>

        <span class="n">processors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">processor</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">processors</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.GzipProcessor">
        <code>
GzipProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.GzipProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor for decompressing gzip files.</p>
<p>It is possible to either define a <code>glob</code> of gzip files
or a <code>path</code> to a single gzip file. If a <code>glob</code> is defined
it is resolved relative to the defined <code>path</code> (default=<code>&lt;dataset dir&gt;</code>).</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Decompress all GZIP logs</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gzip</span><span class="w"></span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather</span><span class="w"></span>
<span class="w">  </span><span class="nt">glob</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*/logs/**/*.gz&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.GzipProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.GzipProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.GzipProcessor.glob">
<code class="highlight language-python"><span class="n">glob</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.GzipProcessor.glob" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The file glob expression to use</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.GzipProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.GzipProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.GzipProcessor.path">
<code class="highlight language-python"><span class="n">path</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.GzipProcessor.path" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The base path to search for the gzipped files.</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.GzipProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.GzipProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.GzipProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.GzipProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Execute the processor and decompress the files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute the processor and decompress the files.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">glob</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glob</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">gzip_file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">gzip_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_in</span><span class="p">:</span>
            <span class="c1"># with suffix replaces .gz ending</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">gzip_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f_out</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">f_in</span><span class="p">,</span> <span class="n">f_out</span><span class="p">)</span>
        <span class="c1"># delete the gzip file</span>
        <span class="n">gzip_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.IngestCreateProcessor">
        <code>
IngestCreateProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.IngestCreateProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor for creating Elasticsearch ingest pipelines.</p>
<p>This processor can be used to create Elasticsearch ingest pipelines
for parsing log event. The log file parsing can then be configured
to use the pipelines for upstream parsing instead of local Logstash
parsing.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add auditd ingest pipeline to elasticsearch</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticsearch.ingest</span><span class="w"></span>
<span class="w">  </span><span class="nt">ingest_pipeline</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/logstash/auditd-ingest.yml</span><span class="w"></span>
<span class="w">  </span><span class="nt">ingest_pipeline_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auditd-logs</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.IngestCreateProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline">
<code class="highlight language-python"><span class="n">ingest_pipeline</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The ingest pipeline to add to elasticsearch</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline_id">
<code class="highlight language-python"><span class="n">ingest_pipeline_id</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline_id" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The id to use for the ingest pipeline</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.IngestCreateProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.IngestCreateProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.IngestCreateProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Execute the processor and configure Elasticsearch ingest pipeline.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute the processor and configure Elasticsearch ingest pipeline.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pipeline_data</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingest_pipeline</span><span class="p">)</span>

    <span class="n">ies</span> <span class="o">=</span> <span class="n">IngestClient</span><span class="p">(</span><span class="n">es</span><span class="p">)</span>

    <span class="n">ies</span><span class="o">.</span><span class="n">put_pipeline</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ingest_pipeline_id</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">pipeline_data</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor">
        <code>
LegacyTemplateCreateProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor for configuring Elasticsearch legacy index templates.</p>
<p>This processor can be used to configure Elasticsearch
index templates. To prepare the Elasticsearch instance
for the parsing phase. See the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-templates-v1.html">legacy index templates doc</a>
for more details.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add pcap index mapping</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticsearch.legacy_template</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/logstash/pcap-index-template.json</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span><span class="w"></span>
<span class="w">  </span><span class="nt">index_patterns</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pcap-*&quot;</span><span class="p p-Indicator">]</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.create_only">
<code class="highlight language-python"><span class="n">create_only</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.create_only" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If true then an existing template with the given name will not be replaced.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.index_patterns">
<code class="highlight language-python"><span class="n">index_patterns</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.index_patterns" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The index patterns the template should be applied to. If this is not set then the index template file must contain this information already!</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.indices_prefix_dataset">
<code class="highlight language-python"><span class="n">indices_prefix_dataset</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.indices_prefix_dataset" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If set to true the <code>&lt;DATASET.name&gt;-</code> is automatically prefixed to each pattern. This is a convenience setting as per default all dataset indices start with this prefix.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.order">
<code class="highlight language-python"><span class="n">order</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.order" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The order to assign to this index template (higher values take precedent).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template">
<code class="highlight language-python"><span class="n">template</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The index template to add to elasticsearch</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template_name">
<code class="highlight language-python"><span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template_name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The name to use for the index template</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Execute the processor and configure Elasticsearch index template.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute the processor and configure Elasticsearch index template.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">template_data</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>

    <span class="c1"># configure the index patterns</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_patterns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">template_data</span><span class="p">[</span><span class="s2">&quot;index_patterns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="c1"># if prefix is on add the prefix to all patterns</span>
            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_patterns</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_prefix_dataset</span>
            <span class="c1"># else add list as is</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_patterns</span>
        <span class="p">)</span>

    <span class="n">ies</span> <span class="o">=</span> <span class="n">IndicesClient</span><span class="p">(</span><span class="n">es</span><span class="p">)</span>

    <span class="n">ies</span><span class="o">.</span><span class="n">put_template</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">template_name</span><span class="p">,</span>
        <span class="n">body</span><span class="o">=</span><span class="n">template_data</span><span class="p">,</span>
        <span class="n">create</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_only</span><span class="p">,</span>
        <span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor">
        <code>
LogstashSetupProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Logstash parser setup processor.</p>
<p>This processor is used to create all the configuration
files required for the Logstash parser (e.g., input and filter configs).
Unless you provide a static Logstash parsing configuration you must
invoke this processor at somepoint during the pre-processing phase.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The processor only does the basic setup any Logstash parsing
filters used for processing specific log events must be prepared
separately.</p>
</div>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup logstash pipeline</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">logstash.setup</span><span class="w"></span>
<span class="w">  </span><span class="nt">context</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">var_files</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/servers.yaml</span><span class="w"></span>
<span class="w">  </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">servers</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.index_template_template">
<code class="highlight language-python"><span class="n">index_template_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.index_template_template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The template to use for the elasticsearch dataset index patterns index template</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_config_name">
<code class="highlight language-python"><span class="n">input_config_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_config_name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The name of the log inputs config file. (relative to the pipeline config dir)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_template">
<code class="highlight language-python"><span class="n">input_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The template to use for the file input plugin configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.legacy_index_template_template">
<code class="highlight language-python"><span class="n">legacy_index_template_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.legacy_index_template_template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The template to use for the elasticsearch dataset legacy index patterns index template</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.logstash_template">
<code class="highlight language-python"><span class="n">logstash_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.logstash_template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The template to use for the logstash configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_config_name">
<code class="highlight language-python"><span class="n">output_config_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_config_name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The name of the log outputs config file. (relative to the pipeline config dir)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_template">
<code class="highlight language-python"><span class="n">output_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The template to use for the file output plugin configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.piplines_template">
<code class="highlight language-python"><span class="n">piplines_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.piplines_template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The template to use for the logstash pipelines configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_name">
<code class="highlight language-python"><span class="n">pre_process_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The file name to use for the pre process filters config. This is prefixed with 0000_ to ensure that the filters are run first.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_template">
<code class="highlight language-python"><span class="n">pre_process_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The template to use for the file output plugin configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.servers">
<code class="highlight language-python"><span class="n">servers</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.servers" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Dictionary of servers and their log configurations</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.use_legacy_template">
<code class="highlight language-python"><span class="n">use_legacy_template</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.use_legacy_template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If the output config should use the legacy index template or the modern index template</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.default_server_timezone">
<code class="highlight language-python"><span class="n">default_server_timezone</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.default_server_timezone" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Validate that each log config entry has a timezone or set default.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>v</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>A single log configuration element</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, Any]</code></td>
      <td><p>The validated and parsed log configuration element</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;servers&quot;</span><span class="p">,</span> <span class="n">each_item</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">default_server_timezone</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Validate that each log config entry has a timezone or set default.</span>

<span class="sd">    Args:</span>
<span class="sd">        v: A single log configuration element</span>

<span class="sd">    Returns:</span>
<span class="sd">        The validated and parsed log configuration element</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;timezone&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
        <span class="n">v</span><span class="p">[</span><span class="s2">&quot;timezone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;UTC&quot;</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Execute the processor and configure Logstash</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute the processor and configure Logstash</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="n">variables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;DATASET_DIR&quot;</span><span class="p">:</span> <span class="n">dataset_dir</span><span class="p">,</span>
            <span class="s2">&quot;DATASET&quot;</span><span class="p">:</span> <span class="n">dataset_config</span><span class="p">,</span>
            <span class="s2">&quot;PARSER&quot;</span><span class="p">:</span> <span class="n">parser_config</span><span class="p">,</span>
            <span class="s2">&quot;servers&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">servers</span><span class="p">,</span>
            <span class="s2">&quot;USE_LEGACY_TEMPLATE&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_legacy_template</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="c1"># add elasticsearch connection variables</span>
    <span class="n">variables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_transport_variables</span><span class="p">(</span><span class="n">es</span><span class="p">))</span>

    <span class="c1"># create all logstash directories</span>
    <span class="n">create_dirs</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">parser_config</span><span class="o">.</span><span class="n">settings_dir</span><span class="p">,</span>
            <span class="n">parser_config</span><span class="o">.</span><span class="n">conf_dir</span><span class="p">,</span>
            <span class="n">parser_config</span><span class="o">.</span><span class="n">data_dir</span><span class="p">,</span>
            <span class="n">parser_config</span><span class="o">.</span><span class="n">log_dir</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># copy jvm and log4j config to settings dir if they don&#39;t exist</span>
    <span class="n">copy_package_file</span><span class="p">(</span>
        <span class="s2">&quot;cr_kyoushi.dataset.files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jvm.options&quot;</span><span class="p">,</span>
        <span class="n">parser_config</span><span class="o">.</span><span class="n">settings_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;jvm.options&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">copy_package_file</span><span class="p">(</span>
        <span class="s2">&quot;cr_kyoushi.dataset.files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;log4j2.properties&quot;</span><span class="p">,</span>
        <span class="n">parser_config</span><span class="o">.</span><span class="n">settings_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;log4j2.properties&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># write logstash configuration</span>
    <span class="n">write_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logstash_template</span><span class="p">,</span>
        <span class="n">parser_config</span><span class="o">.</span><span class="n">settings_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;logstash.yml&quot;</span><span class="p">),</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">es</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># write pipelines configuration</span>
    <span class="n">write_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">piplines_template</span><span class="p">,</span>
        <span class="n">parser_config</span><span class="o">.</span><span class="n">settings_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;pipelines.yml&quot;</span><span class="p">),</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">es</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># write index template</span>
    <span class="n">write_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_template_template</span><span class="p">,</span>
        <span class="n">parser_config</span><span class="o">.</span><span class="n">settings_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-index-template.json&quot;</span>
        <span class="p">),</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">es</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># write legacy index template</span>
    <span class="n">write_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legacy_index_template_template</span><span class="p">,</span>
        <span class="n">parser_config</span><span class="o">.</span><span class="n">settings_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-legacy-index-template.json&quot;</span>
        <span class="p">),</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">es</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># write input configuration</span>
    <span class="n">write_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_template</span><span class="p">,</span>
        <span class="n">parser_config</span><span class="o">.</span><span class="n">conf_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_config_name</span><span class="p">),</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">es</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># write output configuration</span>
    <span class="n">write_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_template</span><span class="p">,</span>
        <span class="n">parser_config</span><span class="o">.</span><span class="n">conf_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_config_name</span><span class="p">),</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">es</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># write pre process configuration</span>
    <span class="n">write_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pre_process_template</span><span class="p">,</span>
        <span class="n">parser_config</span><span class="o">.</span><span class="n">conf_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pre_process_name</span><span class="p">),</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">es</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.validate_servers">
<code class="highlight language-python"><span class="n">validate_servers</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.validate_servers" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Validate the server logs configuration.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>v</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>A single log configuration element</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, Any]</code></td>
      <td><p>The validated and parsed log configuration element</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;servers&quot;</span><span class="p">,</span> <span class="n">each_item</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_servers</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Validate the server logs configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        v: A single log configuration element</span>

<span class="sd">    Returns:</span>
<span class="sd">        The validated and parsed log configuration element</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="s2">&quot;logs&quot;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">,</span> <span class="s2">&quot;Each server must have a logs configuration&quot;</span>
    <span class="n">v</span><span class="p">[</span><span class="s2">&quot;logs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_obj_as</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="n">LogstashLogConfig</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;logs&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor">
        <code>
PcapElasticsearchProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor for converting PCAP files to ndjson format.</p>
<p>This processor uses tshark to convert PCAP files to
a line based JSON format (<code>ek</code> output).</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Convert attacker pcap to elasticsearch json</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap.elasticsearch</span><span class="w"></span>
<span class="w">  </span><span class="nt">pcap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather/attacker_0/logs/ait.aecid.attacker.wpdiscuz/traffic.pcap</span><span class="w"></span>
<span class="w">  </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather/attacker_0/logs/ait.aecid.attacker.wpdiscuz/traffic.json</span><span class="w"></span>
<span class="w">  </span><span class="nt">tls_keylog</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather/attacker_0/logs/ait.aecid.attacker.wpdiscuz/premaster.txt</span><span class="w"></span>
<span class="w">  </span><span class="nt">read_filter</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">udp</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">icmp&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.create_destination_dirs">
<code class="highlight language-python"><span class="n">create_destination_dirs</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.create_destination_dirs" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If the processor should create missing destination parent directories</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.dest">
<code class="highlight language-python"><span class="n">dest</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.dest" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The destination file</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.force">
<code class="highlight language-python"><span class="n">force</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.force" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If the pcap should be created even when the destination file already exists.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_details">
<code class="highlight language-python"><span class="n">packet_details</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_details" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If the packet details should be included, when packet_summary=False then details are always included (-V option).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_summary">
<code class="highlight language-python"><span class="n">packet_summary</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_summary" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If the packet summaries should be included (-P option).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.pcap">
<code class="highlight language-python"><span class="n">pcap</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.pcap" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The pcap file to convert</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter">
<code class="highlight language-python"><span class="n">protocol_match_filter</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Display filter for protocols and their fields (-J option).Parent and child nodes are included for all matches lower level protocols must be added explicitly.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter_parent">
<code class="highlight language-python"><span class="n">protocol_match_filter_parent</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter_parent" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Display filter for protocols and their fields. Only partent nodes are included (-j option).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.read_filter">
<code class="highlight language-python"><span class="n">read_filter</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.read_filter" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The read filter to use when reading the pcap file useful to reduce the number of packets (-Y option)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_filtered">
<code class="highlight language-python"><span class="n">remove_filtered</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_filtered" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Remove filtered fields from the event dicts.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_index_messages">
<code class="highlight language-python"><span class="n">remove_index_messages</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_index_messages" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If the elasticsearch bulk API index messages should be stripped from the output file. Useful when using logstash or similar instead of the bulk API.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tls_keylog">
<code class="highlight language-python"><span class="n">tls_keylog</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tls_keylog" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>TLS keylog file to decrypt TLS on the fly.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tshark_bin">
<code class="highlight language-python"><span class="n">tshark_bin</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tshark_bin" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Path to your tshark binary (searches in common paths if not supplied)</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Execute the processor and convert the pcap file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute the processor and convert the pcap file.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_destination_dirs</span><span class="p">:</span>
        <span class="c1"># create destination parent directory if it does not exist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">force</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="c1"># convert the file</span>
        <span class="n">convert_pcap_to_ecs</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pcap</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tls_keylog</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tshark_bin</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_index_messages</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_filtered</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">packet_summary</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">packet_details</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_filter</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protocol_match_filter</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protocol_match_filter_parent</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PrintProcessor">
        <code>
PrintProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PrintProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Debug processor that simply prints a message.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print Hello World</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">print</span><span class="w"></span>
<span class="w">  </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello World</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PrintProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PrintProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PrintProcessor.msg">
<code class="highlight language-python"><span class="n">msg</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PrintProcessor.msg" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The message to print</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PrintProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PrintProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PrintProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PrintProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PrintProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.PrintProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Print the <code>msg</code></p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Print the `msg`</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.Processor">
        <code>
Processor        </code>



<a class="headerlink" href="#cr_kyoushi.dataset.processors.Processor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Cyber Range Kyoushi Dataset processor interface</p>
<p>For the Cyber Range Kyoushi Dataset tool processors are used
during the pre and post processing phase. A processor class exposes
configuration variables and is executed to achieve a certain task
during the processing phases. They work similar to Ansible modules
and it is possible to use Jinja2 templates and context
variable to define partial configuration.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Render foo template</span><span class="w"></span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span><span class="w"></span>
<span class="w">    </span><span class="nt">context</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">vars</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">foo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bar</span><span class="w"></span>
<span class="w">    </span><span class="nt">var_files</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather/server/foo-bar.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/templates/foo.yaml.j2</span><span class="w"></span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/bar.yaml.j2</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">














  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.Processor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.Processor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Executes the processor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Executes the processor.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.Processor.render">
<code class="highlight language-python"><span class="n">render</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.Processor.render" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Renders all template strings of a processor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>context</code></td>
        <td><code>ProcessorContext</code></td>
        <td><p>The processors context variables</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>The raw templated processor configuration.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, Any]</code></td>
      <td><p>The rendered processor configuration.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Renders all template strings of a processor.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: The processors context variables</span>
<span class="sd">        data: The raw templated processor configuration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The rendered processor configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorBase">
        <code>
ProcessorBase        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorBase" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Pydantic base model of Cyber Range Kyoushi Dataset processor.</p>
<p>Use this base model to implement processors it ensures that
rendering and data loading is done correctly.</p>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorBase.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorBase.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorBase.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorBase.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorBase.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorBase.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorBase.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorBase.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Executes the processor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Executes the processor.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Incomplete processor implementation!&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorBase.render">
<code class="highlight language-python"><span class="n">render</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorBase.render" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Renders all template strings of a processor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>context</code></td>
        <td><code>ProcessorContext</code></td>
        <td><p>The processors context variables</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>data</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>The raw templated processor configuration.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, Any]</code></td>
      <td><p>The rendered processor configuration.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">render</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Renders all template strings of a processor.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: The processors context variables</span>
<span class="sd">        data: The raw templated processor configuration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The rendered processor configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># handle main dict</span>
    <span class="n">data_rendered</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># do not render excluded fields</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">context_render_exclude</span><span class="p">:</span>
            <span class="n">data_rendered</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_render</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data_rendered</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">return</span> <span class="n">data_rendered</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorContainer">
        <code>
ProcessorContainer        </code>



<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorContainer" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Cyber Range Kyoushi Dataset processor container interface</p>
<p>This interface definition defines the API used for
classes implementing processor container types.</p>




  <div class="doc doc-children">














  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorContainer.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorContainer.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Executes the processor.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Executes the processor.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorContainer.processors">
<code class="highlight language-python"><span class="n">processors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorContainer.processors" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns a list of processors contained in this container.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Dict[str, Any]]</code></td>
      <td><p>List of processors</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">processors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Returns a list of processors contained in this container.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of processors</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorContext">
        <code>
ProcessorContext        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorContext" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor context model</p>
<p>This model is used to configure the variable context
used for rendering a processor. It is possible to either
define variables directly (<code>variables</code>) or load them from
variable files (<code>variable_files</code>).</p>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorContext.variable_files">
<code class="highlight language-python"><span class="n">variable_files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorContext.variable_files" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Config files to load into the render context</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorContext.variables">
<code class="highlight language-python"><span class="n">variables</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorContext.variables" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Context variables to use during rendering</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorContext.load">
<code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorContext.load" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Load the configured context variables into a combined dict.</p>
<p>The loaded context variables are cached so that variable files
are only read on the first call of <code>load()</code>.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, Any]</code></td>
      <td><p>A single dict containing all context variables.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Load the configured context variables into a combined dict.</span>

<span class="sd">    The loaded context variables are cached so that variable files</span>
<span class="sd">    are only read on the first call of `load()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A single dict containing all context variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_variables</span> <span class="o">=</span> <span class="n">load_variables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable_files</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_variables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loaded_variables</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorPipeline">
        <code>
ProcessorPipeline        </code>



<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorPipeline" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>The Cyber Range Kyoushi Dataset processing pipeline implementation.</p>
<p>This class is used to configure, parse and execute the pre and post
processing steps.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorPipeline.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processor_map</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorPipeline.__init__" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">


<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>processor_map</code></td>
        <td><code>Optional[Dict[str, Any]]</code></td>
        <td><p>Dict of processors to execute</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processor_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        processor_map: Dict of processors to execute</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">processor_map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">processor_map</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">processor_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">processor_map</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">processor_map</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="n">PrintProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">PrintProcessor</span><span class="p">,</span>
            <span class="n">TemplateProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">TemplateProcessor</span><span class="p">,</span>
            <span class="n">ForEachProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">ForEachProcessor</span><span class="p">,</span>
            <span class="n">CreateDirectoryProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">CreateDirectoryProcessor</span><span class="p">,</span>
            <span class="n">GzipProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">GzipProcessor</span><span class="p">,</span>
            <span class="n">LogstashSetupProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">LogstashSetupProcessor</span><span class="p">,</span>
            <span class="n">PcapElasticsearchProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">PcapElasticsearchProcessor</span><span class="p">,</span>
            <span class="n">ComponentTemplateCreateProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">ComponentTemplateCreateProcessor</span><span class="p">,</span>
            <span class="n">TemplateCreateProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">TemplateCreateProcessor</span><span class="p">,</span>
            <span class="n">LegacyTemplateCreateProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">LegacyTemplateCreateProcessor</span><span class="p">,</span>
            <span class="n">IngestCreateProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">IngestCreateProcessor</span><span class="p">,</span>
            <span class="n">TrimProcessor</span><span class="o">.</span><span class="n">type_</span><span class="p">:</span> <span class="n">TrimProcessor</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ProcessorPipeline.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.ProcessorPipeline.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Executes the processor pipeline by running all the configured processors.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data</code></td>
        <td><code>List[Dict[str, Any]]</code></td>
        <td><p>The raw processor information</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Executes the processor pipeline by running all the configured processors.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: The raw processor information</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pre-validate the processor list</span>
    <span class="c1"># check if all processors have a name and type</span>
    <span class="n">parse_obj_as</span><span class="p">(</span><span class="n">ProcessorList</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="c1"># get the processor context and class</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;context&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">processor_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processor_map</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]]</span>

        <span class="c1"># render the processor template and parse it</span>
        <span class="n">p_rendered</span> <span class="o">=</span> <span class="n">processor_class</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
            <span class="n">context</span><span class="o">=</span><span class="n">ProcessorContext</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">context</span><span class="p">),</span>
            <span class="n">data</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
            <span class="n">es</span><span class="o">=</span><span class="n">es</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">processor</span> <span class="o">=</span> <span class="n">processor_class</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">p_rendered</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">processor</span><span class="p">,</span> <span class="n">ProcessorContainer</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expanding processor container - </span><span class="si">{</span><span class="n">processor</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> ...&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="n">processor</span><span class="o">.</span><span class="n">processors</span><span class="p">(),</span>
                <span class="n">dataset_dir</span><span class="p">,</span>
                <span class="n">dataset_config</span><span class="p">,</span>
                <span class="n">parser_config</span><span class="p">,</span>
                <span class="n">es</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Executing - </span><span class="si">{</span><span class="n">processor</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> ...&quot;</span><span class="p">)</span>
            <span class="n">processor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor">
        <code>
TemplateCreateProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor for configuring Elasticsearch index templates.</p>
<p>This processor can be used to configure Elasticsearch
index templates. To prepare the Elasticsearch instance
for the parsing phase. See the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-templates.html">index templates doc</a>
for more details.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add pcap index mapping</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticsearch.template</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/logstash/pcap-index-template.json</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span><span class="w"></span>
<span class="w">  </span><span class="nt">index_patterns</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pcap-*&quot;</span><span class="p p-Indicator">]</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.composed_of">
<code class="highlight language-python"><span class="n">composed_of</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.composed_of" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Optional list of component templates the index template should be composed of.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.create_only">
<code class="highlight language-python"><span class="n">create_only</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.create_only" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If true then an existing template with the given name will not be replaced.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.index_patterns">
<code class="highlight language-python"><span class="n">index_patterns</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.index_patterns" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The index patterns the template should be applied to. If this is not set then the index template file must contain this information already!</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.indices_prefix_dataset">
<code class="highlight language-python"><span class="n">indices_prefix_dataset</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.indices_prefix_dataset" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If set to true the <code>&lt;DATASET.name&gt;-</code> is automatically prefixed to each pattern. This is a convenience setting as per default all dataset indices start with this prefix.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.priority">
<code class="highlight language-python"><span class="n">priority</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.priority" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The priority to assign to this index template (higher values take precedent).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.template">
<code class="highlight language-python"><span class="n">template</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.template" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The index template to add to elasticsearch</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.template_name">
<code class="highlight language-python"><span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.template_name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The name to use for the index template</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Execute the processor and configure Elasticsearch index template.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute the processor and configure Elasticsearch index template.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">template_data</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>

    <span class="c1"># configure the index patterns</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_patterns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">template_data</span><span class="p">[</span><span class="s2">&quot;index_patterns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="c1"># if prefix is on add the prefix to all patterns</span>
            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_patterns</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_prefix_dataset</span>
            <span class="c1"># else add list as is</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_patterns</span>
        <span class="p">)</span>

    <span class="c1"># set template priority to given value</span>
    <span class="n">template_data</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">composed_of</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">template_data</span><span class="p">[</span><span class="s2">&quot;composed_of&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">composed_of</span>

    <span class="n">ies</span> <span class="o">=</span> <span class="n">IndicesClient</span><span class="p">(</span><span class="n">es</span><span class="p">)</span>

    <span class="n">ies</span><span class="o">.</span><span class="n">put_index_template</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">template_name</span><span class="p">,</span>
        <span class="n">body</span><span class="o">=</span><span class="n">template_data</span><span class="p">,</span>
        <span class="n">create</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_only</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor">
        <code>
TemplateProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor for rendering template files.</p>
<p>In addition to the normal processor context it
is also possible to define a <code>template_context</code>.
If <code>template_context</code> is defined it will be used for
rendering the template otherwise the normal processor
context will be used.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Rendering labeling rule {{ item.src }}</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_context</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">var_files</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">attacker</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/attacker.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">escalate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/escalate.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">foothold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/foothold.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/servers.yaml</span><span class="w"></span>
<span class="w">  </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;processing/templates/rules/{{</span><span class="nv"> </span><span class="s">item.src</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;rules/{{</span><span class="nv"> </span><span class="s">item.dest</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.dest">
<code class="highlight language-python"><span class="n">dest</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.dest" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The destination to save the rendered file to</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.src">
<code class="highlight language-python"><span class="n">src</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.src" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The template file to render</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.template_context">
<code class="highlight language-python"><span class="n">template_context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.template_context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Optional template context if this is not set the processor context is used instead</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Load and render the template file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Load and render the template file.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">template_context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">template_context</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;DATASET_DIR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_dir</span>
    <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;DATASET&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_config</span>
    <span class="n">variables</span><span class="p">[</span><span class="s2">&quot;PARSER&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parser_config</span>

    <span class="n">write_template</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">absolute</span><span class="p">(),</span> <span class="n">variables</span><span class="p">,</span> <span class="n">es</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor">
        <code>
TrimProcessor        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Processor for trimming log files to a defined time frame.</p>
<p>This processor can be used to remove all log lines outside
of defined dataset observation times.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently only support simple time frames with a single
start and end time.</p>
</div>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Trim server logs to observation time</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataset.trim</span><span class="w"></span>
<span class="w">  </span><span class="nt">context</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">var_files</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">groups</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/groups.yaml</span><span class="w"></span>
<span class="w">  </span><span class="c1"># we only want to trim the logs of servers that will be part</span><span class="w"></span>
<span class="w">  </span><span class="c1"># of the IDS dataset</span><span class="w"></span>
<span class="w">  </span><span class="nt">indices</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">attacker_0-*</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.context">
<code class="highlight language-python"><span class="n">context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.context" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The variable context for the processor</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.end">
<code class="highlight language-python"><span class="n">end</span><span class="p">:</span> <span class="n">datetime</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.end" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The end time to trim the logs to (defaults to dataset end)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.exclude">
<code class="highlight language-python"><span class="n">exclude</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.exclude" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Indices to exclude from triming. This will overwrite/exclude indices from any patterns supplied in <code>indices</code></p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.indices">
<code class="highlight language-python"><span class="n">indices</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.indices" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The log indices to trim (defaults to <code>&lt;dataset&gt;-*</code>)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.indices_prefix_dataset">
<code class="highlight language-python"><span class="n">indices_prefix_dataset</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.indices_prefix_dataset" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>If set to true the <code>&lt;DATASET.name&gt;-</code> is automatically prefixed to each pattern. This is a convenience setting as per default all dataset indices start with this prefix.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.name">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.name" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processors name</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.start">
<code class="highlight language-python"><span class="n">start</span><span class="p">:</span> <span class="n">datetime</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.start" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The start time to trim the logs to (defaults to dataset start)</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.type_field">
<code class="highlight language-python"><span class="n">type_field</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.type_field" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>The processor type as passed in from the config</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.execute">
<code class="highlight language-python"><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_dir</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">,</span> <span class="n">parser_config</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.execute" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Execute the processor and trim the log files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dataset_dir</code></td>
        <td><code>Path</code></td>
        <td><p>The dataset path</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_config</code></td>
        <td><code>DatasetConfig</code></td>
        <td><p>The dataset configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>parser_config</code></td>
        <td><code>LogstashParserConfig</code></td>
        <td><p>The dataset parser configuration</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">parser_config</span><span class="p">:</span> <span class="n">LogstashParserConfig</span><span class="p">,</span>
    <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Execute the processor and trim the log files.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_dir: The dataset path</span>
<span class="sd">        dataset_config: The dataset configuration</span>
<span class="sd">        parser_config: The dataset parser configuration</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># if not explicitly set use dataset root indices pattern</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-*&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span>
            <span class="c1"># if given and prefix flag is True add dataset name prefix</span>
            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_prefix_dataset</span>
            <span class="k">else</span>
            <span class="c1"># otherwise use as is</span>
            <span class="n">indices</span>
        <span class="p">)</span>

    <span class="n">exclude</span> <span class="o">=</span> <span class="p">(</span>
        <span class="c1"># add negative match indicator &#39;-&#39; and dataset name prefix</span>
        <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">exc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclude</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_prefix_dataset</span>
        <span class="c1"># add negative match indicator only</span>
        <span class="k">else</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">exc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exclude</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">start</span>
    <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="ow">or</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">end</span>
    <span class="c1"># exclude must be after indices for negative patterns to work as expected</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">indices</span> <span class="o">+</span> <span class="n">exclude</span>

    <span class="c1"># get documents before trim</span>
    <span class="n">docs_before</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">bucket</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">path</span><span class="p">:</span> <span class="n">bucket</span><span class="o">.</span><span class="n">doc_count</span>
        <span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line_stats</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">remove</span> <span class="o">=</span> <span class="n">Search</span><span class="p">(</span><span class="n">using</span><span class="o">=</span><span class="n">es</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
    <span class="c1"># setup trim range filter</span>
    <span class="c1"># start &gt;= @timestamp &lt; end</span>
    <span class="n">valid_range</span> <span class="o">=</span> <span class="n">Range</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;@timestamp&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;gte&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s2">&quot;lt&quot;</span><span class="p">:</span> <span class="n">end</span><span class="p">}})</span>

    <span class="c1"># remove all elements outside of range i.e., `not` valid_range</span>
    <span class="n">remove</span> <span class="o">=</span> <span class="n">remove</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">~</span><span class="n">valid_range</span><span class="p">)</span>
    <span class="c1"># refresh=&quot;true&quot; is important to ensure consecutive queries</span>
    <span class="c1"># use up to date information</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">remove</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="n">refresh</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="n">request_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

    <span class="c1"># lines after trim</span>
    <span class="n">lines_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_line_stats</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

    <span class="c1"># trim each file</span>
    <span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">lines_after</span><span class="p">:</span>
        <span class="n">first_line</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bucket</span><span class="o">.</span><span class="n">min_line</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">last_line</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bucket</span><span class="o">.</span><span class="n">max_line</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">docs_before</span><span class="p">[</span><span class="n">bucket</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">path</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">first_line</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">last_line</span><span class="p">:</span>
            <span class="c1"># if our last line is already correct we set it to None and skip truncate</span>
            <span class="c1"># since truncating requires us to read up to the truncate point</span>
            <span class="n">last_line</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">trim_file</span><span class="p">(</span><span class="n">bucket</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">first_line</span><span class="p">,</span> <span class="n">last_line</span><span class="p">)</span>
        <span class="c1"># delete entry for this file so we later can detect if a file must be deleted completely</span>
        <span class="k">del</span> <span class="n">docs_before</span><span class="p">[</span><span class="n">bucket</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">path</span><span class="p">]</span>

    <span class="c1"># any file that still has a docs before entry</span>
    <span class="c1"># does not have any logs within the trim range and thus should be deleted</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">docs_before</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Removing </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2"> as it does not have any log lines within the observation time.&quot;</span>
        <span class="p">)</span>
        <span class="c1"># delete the file</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

    <span class="c1"># update entries in elastic search</span>
    <span class="n">update_lines</span> <span class="o">=</span> <span class="n">UpdateByQuery</span><span class="p">(</span><span class="n">using</span><span class="o">=</span><span class="n">es</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
    <span class="c1"># adjust map for shifting line numbers in the db to start at our new min line</span>
    <span class="n">adjust_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">bucket</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">path</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">bucket</span><span class="o">.</span><span class="n">min_line</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">lines_after</span>
        <span class="c1"># only include paths that need actual changing</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">bucket</span><span class="o">.</span><span class="n">min_line</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">}</span>

    <span class="c1"># we only have entries to update if the adjust map is non empty</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">adjust_map</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># pre filter our update query to only include file paths we</span>
        <span class="c1"># want to update</span>
        <span class="n">update_lines</span> <span class="o">=</span> <span class="n">update_lines</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="s2">&quot;terms&quot;</span><span class="p">,</span>
            <span class="n">log__file__path</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">adjust_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
        <span class="p">)</span>

        <span class="c1"># ToDO might be better as async query due to threat of timeouts</span>
        <span class="c1"># (i.e., update_lines.to_dict() and then use low level async API)</span>
        <span class="n">update_lines</span><span class="o">.</span><span class="n">script</span><span class="p">(</span>
            <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;painless&quot;</span><span class="p">,</span>
            <span class="c1"># subtract matching the entries log file path</span>
            <span class="n">source</span><span class="o">=</span><span class="s2">&quot;ctx._source.log.file.line -= params[ctx._source.log.file.path]&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">adjust_map</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.get_doc_stats">
<code class="highlight language-python"><span class="n">get_doc_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">es</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.get_doc_stats" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Get a list of unique log file paths.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>index</code></td>
        <td><code>List[str]</code></td>
        <td><p>The indices to get the data for</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[elasticsearch_dsl.response.aggs.Bucket]</code></td>
      <td><p>List of log file paths.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_doc_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Bucket</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get a list of unique log file paths.</span>

<span class="sd">    Args:</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">        index: The indices to get the data for</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of log file paths.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># disable request cache to ensure we always get latest info</span>
    <span class="n">search_lines</span> <span class="o">=</span> <span class="n">Search</span><span class="p">(</span><span class="n">using</span><span class="o">=</span><span class="n">es</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="n">request_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># setup aggregations</span>
    <span class="n">search_lines</span><span class="o">.</span><span class="n">aggs</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span>
        <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;composite&quot;</span><span class="p">,</span>
        <span class="n">sources</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;terms&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;log.file.path&quot;</span><span class="p">}}}],</span>
    <span class="p">)</span>

    <span class="c1"># use custom scan function to ensure we get all the buckets</span>
    <span class="k">return</span> <span class="n">scan_composite</span><span class="p">(</span><span class="n">search_lines</span><span class="p">,</span> <span class="s2">&quot;files&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.get_line_stats">
<code class="highlight language-python"><span class="n">get_line_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">es</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></code>


<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.get_line_stats" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Retrieve minimum and maximum line numbers for the log files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>es</code></td>
        <td><code>Elasticsearch</code></td>
        <td><p>The elasticsearch client object</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>index</code></td>
        <td><code>List[str]</code></td>
        <td><p>The indices to get the stats for</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[elasticsearch_dsl.response.aggs.Bucket]</code></td>
      <td><p>List of min and max line numbers per file</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>dataset/processors.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_line_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">es</span><span class="p">:</span> <span class="n">Elasticsearch</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Bucket</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Retrieve minimum and maximum line numbers for the log files.</span>

<span class="sd">    Args:</span>
<span class="sd">        es: The elasticsearch client object</span>
<span class="sd">        index: The indices to get the stats for</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of min and max line numbers per file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># disable request cache to ensure we always get latest info</span>
    <span class="n">search_lines</span> <span class="o">=</span> <span class="n">Search</span><span class="p">(</span><span class="n">using</span><span class="o">=</span><span class="n">es</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="n">request_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># setup aggregations</span>
    <span class="n">search_lines</span><span class="o">.</span><span class="n">aggs</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span>
        <span class="s2">&quot;files&quot;</span><span class="p">,</span>
        <span class="s2">&quot;composite&quot;</span><span class="p">,</span>
        <span class="n">sources</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;terms&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;log.file.path&quot;</span><span class="p">}}}],</span>
    <span class="p">)</span>
    <span class="n">search_lines</span><span class="o">.</span><span class="n">aggs</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;min_line&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;log.file.line&quot;</span><span class="p">)</span>
    <span class="n">search_lines</span><span class="o">.</span><span class="n">aggs</span><span class="p">[</span><span class="s2">&quot;files&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s2">&quot;max_line&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;log.file.line&quot;</span><span class="p">)</span>
    <span class="c1"># use custom scan function to ensure we get all the buckets</span>
    <span class="k">return</span> <span class="n">scan_composite</span><span class="p">(</span><span class="n">search_lines</span><span class="p">,</span> <span class="s2">&quot;files&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../pcap/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                PCAP Utilities
              </div>
            </div>
          </a>
        
        
          <a href="../sample/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Sampling
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../js/jquery-3.5.1.min.js"></script>
      
        <script src="../../js/jquery.fancybox.min.js"></script>
      
    
  </body>
</html>