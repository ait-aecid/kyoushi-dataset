
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="IDS Dataset processing and labeling tool.">
      
      
      
      
        <link rel="canonical" href="https://ait-aecid.github.io/kyoushi-dataset/processors/">
      
      <link rel="shortcut icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-6.2.8">
    
    
      
        <title>Dataset Processors - Cyber Range Kyoushi Dataset</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../stylesheets/jquery.fancybox.min.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="ait" data-md-color-primary="" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dataset-processors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://ait-aecid.github.io/kyoushi-dataset/" title="Cyber Range Kyoushi Dataset" class="md-header-nav__button md-logo" aria-label="Cyber Range Kyoushi Dataset">
      
  <img src="../images/cr_icon.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Cyber Range Kyoushi Dataset
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Dataset Processors
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ait-aecid/kyoushi-dataset/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kyoushi-dataset
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ait-aecid.github.io/kyoushi-dataset/" title="Cyber Range Kyoushi Dataset" class="md-nav__button md-logo" aria-label="Cyber Range Kyoushi Dataset">
      
  <img src="../images/cr_icon.svg" alt="logo">

    </a>
    Cyber Range Kyoushi Dataset
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ait-aecid/kyoushi-dataset/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    kyoushi-dataset
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/intro/" class="md-nav__link">
        Intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/prepare/" class="md-nav__link">
        Prepare Dataset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/process/" class="md-nav__link">
        Process Dataset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/label/" class="md-nav__link">
        Label Dataset
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/sample/" class="md-nav__link">
        Sample Labels
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../examples/process/" class="md-nav__link">
        Dataset Processing
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Dataset Processors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Dataset Processors
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#util-and-debug" class="md-nav__link">
    Util and Debug
  </a>
  
    <nav class="md-nav" aria-label="Util and Debug">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#console-print-print" class="md-nav__link">
    Console Print (print)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-manipulation" class="md-nav__link">
    File Manipulation
  </a>
  
    <nav class="md-nav" aria-label="File Manipulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-directory-mkdir" class="md-nav__link">
    Create Directory (mkdir)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gzip-decompress-gzip" class="md-nav__link">
    GZip Decompress (gzip)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-template-template" class="md-nav__link">
    File Template (template)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-trimming-trim" class="md-nav__link">
    File Trimming (trim)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcap-conversion-pcapelasticsearch" class="md-nav__link">
    PCAP Conversion (pcap.elasticsearch)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elasticsearch" class="md-nav__link">
    Elasticsearch
  </a>
  
    <nav class="md-nav" aria-label="Elasticsearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elasticsearch-ingest-pipeline-elasticsearchingest" class="md-nav__link">
    Elasticsearch ingest pipeline (elasticsearch.ingest)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elasticsearch-index-template-elasticsearchtemplate" class="md-nav__link">
    Elasticsearch Index Template (elasticsearch.template)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elasticsearch-index-component-template-elasticsearchcomponent_template" class="md-nav__link">
    Elasticsearch Index Component Template (elasticsearch.component_template)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elasticsearch-legacy-index-template-elasticsearchlegacy_template" class="md-nav__link">
    Elasticsearch Legacy Index Template (elasticsearch.legacy_template)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logstash" class="md-nav__link">
    Logstash
  </a>
  
    <nav class="md-nav" aria-label="Logstash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logstash-setup-logstashsetup" class="md-nav__link">
    Logstash setup (logstash.setup)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-flow-and-logic" class="md-nav__link">
    Data Flow and Logic
  </a>
  
    <nav class="md-nav" aria-label="Data Flow and Logic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#foreach-loop-foreach" class="md-nav__link">
    ForEach Loop (foreach)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../rules/" class="md-nav__link">
        Labeling Rules
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        CLI Reference
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
      
      <label class="md-nav__link" for="nav-7">
        Code Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Code Reference" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../reference/config/" class="md-nav__link">
        Config
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../reference/elasticsearch/" class="md-nav__link">
        Elasticsearch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../reference/labels/" class="md-nav__link">
        Labels
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../reference/parser/" class="md-nav__link">
        Parser
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../reference/pcap/" class="md-nav__link">
        PCAP Utilities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../reference/processors/" class="md-nav__link">
        Processors
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sample/" class="md-nav__link">
        Sampling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../reference/templates/" class="md-nav__link">
        Templates
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../reference/utils/" class="md-nav__link">
        Utility Functions
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#util-and-debug" class="md-nav__link">
    Util and Debug
  </a>
  
    <nav class="md-nav" aria-label="Util and Debug">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#console-print-print" class="md-nav__link">
    Console Print (print)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-manipulation" class="md-nav__link">
    File Manipulation
  </a>
  
    <nav class="md-nav" aria-label="File Manipulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-directory-mkdir" class="md-nav__link">
    Create Directory (mkdir)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gzip-decompress-gzip" class="md-nav__link">
    GZip Decompress (gzip)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-template-template" class="md-nav__link">
    File Template (template)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-trimming-trim" class="md-nav__link">
    File Trimming (trim)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pcap-conversion-pcapelasticsearch" class="md-nav__link">
    PCAP Conversion (pcap.elasticsearch)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elasticsearch" class="md-nav__link">
    Elasticsearch
  </a>
  
    <nav class="md-nav" aria-label="Elasticsearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elasticsearch-ingest-pipeline-elasticsearchingest" class="md-nav__link">
    Elasticsearch ingest pipeline (elasticsearch.ingest)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elasticsearch-index-template-elasticsearchtemplate" class="md-nav__link">
    Elasticsearch Index Template (elasticsearch.template)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elasticsearch-index-component-template-elasticsearchcomponent_template" class="md-nav__link">
    Elasticsearch Index Component Template (elasticsearch.component_template)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#elasticsearch-legacy-index-template-elasticsearchlegacy_template" class="md-nav__link">
    Elasticsearch Legacy Index Template (elasticsearch.legacy_template)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logstash" class="md-nav__link">
    Logstash
  </a>
  
    <nav class="md-nav" aria-label="Logstash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logstash-setup-logstashsetup" class="md-nav__link">
    Logstash setup (logstash.setup)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-flow-and-logic" class="md-nav__link">
    Data Flow and Logic
  </a>
  
    <nav class="md-nav" aria-label="Data Flow and Logic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#foreach-loop-foreach" class="md-nav__link">
    ForEach Loop (foreach)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ait-aecid/kyoushi-dataset/edit/main/docs/processors.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="dataset-processors">Dataset Processors<a class="headerlink" href="#dataset-processors" title="Permanent link">&para;</a></h1>
<p>On this page you can learn about the various dataset processors available with Cyber Range Kyoushi Dataset.</p>
<h2 id="util-and-debug">Util and Debug<a class="headerlink" href="#util-and-debug" title="Permanent link">&para;</a></h2>
<h3 id="console-print-print">Console Print (<code>print</code>)<a class="headerlink" href="#console-print-print" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Debug processor that simply prints a message.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print Hello World</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">print</span><span class="w"></span>
<span class="w">  </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello World</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PrintProcessor.msg">
<code class="highlight language-python"><span class="n">msg</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PrintProcessor.msg" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The message to print</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h2 id="file-manipulation">File Manipulation<a class="headerlink" href="#file-manipulation" title="Permanent link">&para;</a></h2>
<h3 id="create-directory-mkdir">Create Directory (<code>mkdir</code>)<a class="headerlink" href="#create-directory-mkdir" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Processor for creating file directories.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensure processing config directory exists</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mkdir</span><span class="w"></span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.CreateDirectoryProcessor.path">
<code class="highlight language-python"><span class="n">path</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.path" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The directory path to create</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.CreateDirectoryProcessor.recursive">
<code class="highlight language-python"><span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.CreateDirectoryProcessor.recursive" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If all missing parent directories should als be created</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h3 id="gzip-decompress-gzip">GZip Decompress (<code>gzip</code>)<a class="headerlink" href="#gzip-decompress-gzip" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Processor for decompressing gzip files.</p>
<p>It is possible to either define a <code>glob</code> of gzip files
or a <code>path</code> to a single gzip file. If a <code>glob</code> is defined
it is resolved relative to the defined <code>path</code> (default=<code>&lt;dataset dir&gt;</code>).</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Decompress all GZIP logs</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gzip</span><span class="w"></span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather</span><span class="w"></span>
<span class="w">  </span><span class="nt">glob</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*/logs/**/*.gz&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.GzipProcessor.glob">
<code class="highlight language-python"><span class="n">glob</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.GzipProcessor.glob" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The file glob expression to use</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.GzipProcessor.path">
<code class="highlight language-python"><span class="n">path</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.GzipProcessor.path" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The base path to search for the gzipped files.</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h3 id="file-template-template">File Template (<code>template</code>)<a class="headerlink" href="#file-template-template" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Processor for rendering template files.</p>
<p>In addition to the normal processor context it
is also possible to define a <code>template_context</code>.
If <code>template_context</code> is defined it will be used for
rendering the template otherwise the normal processor
context will be used.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span><span class="w"></span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Rendering labeling rule {{ item.src }}</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_context</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">var_files</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">attacker</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/attacker.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">escalate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/escalate.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">foothold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/foothold.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/servers.yaml</span><span class="w"></span>
<span class="w">  </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;processing/templates/rules/{{</span><span class="nv"> </span><span class="s">item.src</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
<span class="w">  </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;rules/{{</span><span class="nv"> </span><span class="s">item.dest</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.dest">
<code class="highlight language-python"><span class="n">dest</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.dest" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The destination to save the rendered file to</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.src">
<code class="highlight language-python"><span class="n">src</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.src" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The template file to render</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateProcessor.template_context">
<code class="highlight language-python"><span class="n">template_context</span><span class="p">:</span> <span class="n">ProcessorContext</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateProcessor.template_context" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Optional template context if this is not set the processor context is used instead</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h3 id="file-trimming-trim">File Trimming (<code>trim</code>)<a class="headerlink" href="#file-trimming-trim" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Processor for trimming log files to a defined time frame.</p>
<p>This processor can be used to remove all log lines outside
of defined dataset observation times.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently only support simple time frames with a single
start and end time.</p>
</div>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Trim server logs to observation time</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dataset.trim</span><span class="w"></span>
<span class="w">  </span><span class="nt">context</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">var_files</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">groups</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/groups.yaml</span><span class="w"></span>
<span class="w">  </span><span class="c1"># we only want to trim the logs of servers that will be part</span><span class="w"></span>
<span class="w">  </span><span class="c1"># of the IDS dataset</span><span class="w"></span>
<span class="w">  </span><span class="nt">indices</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">attacker_0-*</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.end">
<code class="highlight language-python"><span class="n">end</span><span class="p">:</span> <span class="n">datetime</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.end" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The end time to trim the logs to (defaults to dataset end)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.exclude">
<code class="highlight language-python"><span class="n">exclude</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.exclude" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Indices to exclude from triming. This will overwrite/exclude indices from any patterns supplied in <code>indices</code></p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.indices">
<code class="highlight language-python"><span class="n">indices</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.indices" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The log indices to trim (defaults to <code>&lt;dataset&gt;-*</code>)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.indices_prefix_dataset">
<code class="highlight language-python"><span class="n">indices_prefix_dataset</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.indices_prefix_dataset" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If set to true the <code>&lt;DATASET.name&gt;-</code> is automatically prefixed to each pattern. This is a convenience setting as per default all dataset indices start with this prefix.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TrimProcessor.start">
<code class="highlight language-python"><span class="n">start</span><span class="p">:</span> <span class="n">datetime</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TrimProcessor.start" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The start time to trim the logs to (defaults to dataset start)</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h3 id="pcap-conversion-pcapelasticsearch">PCAP Conversion (<code>pcap.elasticsearch</code>)<a class="headerlink" href="#pcap-conversion-pcapelasticsearch" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Processor for converting PCAP files to ndjson format.</p>
<p>This processor uses tshark to convert PCAP files to
a line based JSON format (<code>ek</code> output).</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Convert attacker pcap to elasticsearch json</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap.elasticsearch</span><span class="w"></span>
<span class="w">  </span><span class="nt">pcap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather/attacker_0/logs/ait.aecid.attacker.wpdiscuz/traffic.pcap</span><span class="w"></span>
<span class="w">  </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather/attacker_0/logs/ait.aecid.attacker.wpdiscuz/traffic.json</span><span class="w"></span>
<span class="w">  </span><span class="nt">tls_keylog</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gather/attacker_0/logs/ait.aecid.attacker.wpdiscuz/premaster.txt</span><span class="w"></span>
<span class="w">  </span><span class="nt">read_filter</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">udp</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">icmp&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.create_destination_dirs">
<code class="highlight language-python"><span class="n">create_destination_dirs</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.create_destination_dirs" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If the processor should create missing destination parent directories</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.dest">
<code class="highlight language-python"><span class="n">dest</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.dest" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The destination file</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.force">
<code class="highlight language-python"><span class="n">force</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.force" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If the pcap should be created even when the destination file already exists.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_details">
<code class="highlight language-python"><span class="n">packet_details</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_details" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If the packet details should be included, when packet_summary=False then details are always included (-V option).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_summary">
<code class="highlight language-python"><span class="n">packet_summary</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.packet_summary" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If the packet summaries should be included (-P option).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.pcap">
<code class="highlight language-python"><span class="n">pcap</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.pcap" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The pcap file to convert</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter">
<code class="highlight language-python"><span class="n">protocol_match_filter</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Display filter for protocols and their fields (-J option).Parent and child nodes are included for all matches lower level protocols must be added explicitly.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter_parent">
<code class="highlight language-python"><span class="n">protocol_match_filter_parent</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.protocol_match_filter_parent" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Display filter for protocols and their fields. Only partent nodes are included (-j option).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.read_filter">
<code class="highlight language-python"><span class="n">read_filter</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.read_filter" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The read filter to use when reading the pcap file useful to reduce the number of packets (-Y option)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_filtered">
<code class="highlight language-python"><span class="n">remove_filtered</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_filtered" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Remove filtered fields from the event dicts.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_index_messages">
<code class="highlight language-python"><span class="n">remove_index_messages</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.remove_index_messages" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If the elasticsearch bulk API index messages should be stripped from the output file. Useful when using logstash or similar instead of the bulk API.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tls_keylog">
<code class="highlight language-python"><span class="n">tls_keylog</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tls_keylog" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>TLS keylog file to decrypt TLS on the fly.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tshark_bin">
<code class="highlight language-python"><span class="n">tshark_bin</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.PcapElasticsearchProcessor.tshark_bin" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Path to your tshark binary (searches in common paths if not supplied)</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h2 id="elasticsearch">Elasticsearch<a class="headerlink" href="#elasticsearch" title="Permanent link">&para;</a></h2>
<h3 id="elasticsearch-ingest-pipeline-elasticsearchingest">Elasticsearch ingest pipeline (<code>elasticsearch.ingest</code>)<a class="headerlink" href="#elasticsearch-ingest-pipeline-elasticsearchingest" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Processor for creating Elasticsearch ingest pipelines.</p>
<p>This processor can be used to create Elasticsearch ingest pipelines
for parsing log event. The log file parsing can then be configured
to use the pipelines for upstream parsing instead of local Logstash
parsing.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add auditd ingest pipeline to elasticsearch</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticsearch.ingest</span><span class="w"></span>
<span class="w">  </span><span class="nt">ingest_pipeline</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/logstash/auditd-ingest.yml</span><span class="w"></span>
<span class="w">  </span><span class="nt">ingest_pipeline_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auditd-logs</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline">
<code class="highlight language-python"><span class="n">ingest_pipeline</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The ingest pipeline to add to elasticsearch</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline_id">
<code class="highlight language-python"><span class="n">ingest_pipeline_id</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.IngestCreateProcessor.ingest_pipeline_id" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The id to use for the ingest pipeline</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h3 id="elasticsearch-index-template-elasticsearchtemplate">Elasticsearch Index Template (<code>elasticsearch.template</code>)<a class="headerlink" href="#elasticsearch-index-template-elasticsearchtemplate" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Processor for configuring Elasticsearch index templates.</p>
<p>This processor can be used to configure Elasticsearch
index templates. To prepare the Elasticsearch instance
for the parsing phase. See the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-templates.html">index templates doc</a>
for more details.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add pcap index mapping</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticsearch.template</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/logstash/pcap-index-template.json</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span><span class="w"></span>
<span class="w">  </span><span class="nt">index_patterns</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pcap-*&quot;</span><span class="p p-Indicator">]</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.composed_of">
<code class="highlight language-python"><span class="n">composed_of</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.composed_of" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Optional list of component templates the index template should be composed of.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.create_only">
<code class="highlight language-python"><span class="n">create_only</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.create_only" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If true then an existing template with the given name will not be replaced.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.index_patterns">
<code class="highlight language-python"><span class="n">index_patterns</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.index_patterns" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The index patterns the template should be applied to. If this is not set then the index template file must contain this information already!</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.indices_prefix_dataset">
<code class="highlight language-python"><span class="n">indices_prefix_dataset</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.indices_prefix_dataset" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If set to true the <code>&lt;DATASET.name&gt;-</code> is automatically prefixed to each pattern. This is a convenience setting as per default all dataset indices start with this prefix.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.priority">
<code class="highlight language-python"><span class="n">priority</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.priority" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The priority to assign to this index template (higher values take precedent).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.template">
<code class="highlight language-python"><span class="n">template</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The index template to add to elasticsearch</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.TemplateCreateProcessor.template_name">
<code class="highlight language-python"><span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.TemplateCreateProcessor.template_name" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The name to use for the index template</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h3 id="elasticsearch-index-component-template-elasticsearchcomponent_template">Elasticsearch Index Component Template (<code>elasticsearch.component_template</code>)<a class="headerlink" href="#elasticsearch-index-component-template-elasticsearchcomponent_template" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Processor for creating Elasticsearch index component templates.</p>
<p>This processor can be used to create Elasticsearch
index component templates. To prepare the Elasticsearch instance
for the parsing phase. See the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-templates.html">index templates doc</a>
for more details.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add pcap component template</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticsearch.component_template</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/logstash/pcap-component-template.json</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.create_only">
<code class="highlight language-python"><span class="n">create_only</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.create_only" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If true then an existing template with the given name will not be replaced.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template">
<code class="highlight language-python"><span class="n">template</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The index component template to add to elasticsearch</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template_name">
<code class="highlight language-python"><span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ComponentTemplateCreateProcessor.template_name" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The name to use for the index component template</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h3 id="elasticsearch-legacy-index-template-elasticsearchlegacy_template">Elasticsearch Legacy Index Template (<code>elasticsearch.legacy_template</code>)<a class="headerlink" href="#elasticsearch-legacy-index-template-elasticsearchlegacy_template" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Processor for configuring Elasticsearch legacy index templates.</p>
<p>This processor can be used to configure Elasticsearch
index templates. To prepare the Elasticsearch instance
for the parsing phase. See the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-templates-v1.html">legacy index templates doc</a>
for more details.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add pcap index mapping</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">elasticsearch.legacy_template</span><span class="w"></span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/logstash/pcap-index-template.json</span><span class="w"></span>
<span class="w">  </span><span class="nt">template_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span><span class="w"></span>
<span class="w">  </span><span class="nt">index_patterns</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pcap-*&quot;</span><span class="p p-Indicator">]</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.create_only">
<code class="highlight language-python"><span class="n">create_only</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.create_only" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If true then an existing template with the given name will not be replaced.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.index_patterns">
<code class="highlight language-python"><span class="n">index_patterns</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.index_patterns" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The index patterns the template should be applied to. If this is not set then the index template file must contain this information already!</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.indices_prefix_dataset">
<code class="highlight language-python"><span class="n">indices_prefix_dataset</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.indices_prefix_dataset" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If set to true the <code>&lt;DATASET.name&gt;-</code> is automatically prefixed to each pattern. This is a convenience setting as per default all dataset indices start with this prefix.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.order">
<code class="highlight language-python"><span class="n">order</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.order" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The order to assign to this index template (higher values take precedent).</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template">
<code class="highlight language-python"><span class="n">template</span><span class="p">:</span> <span class="n">FilePath</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The index template to add to elasticsearch</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template_name">
<code class="highlight language-python"><span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LegacyTemplateCreateProcessor.template_name" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The name to use for the index template</p>
    </div>

  </div>










  </div>

    </div>

  </div>

<h2 id="logstash">Logstash<a class="headerlink" href="#logstash" title="Permanent link">&para;</a></h2>
<h3 id="logstash-setup-logstashsetup">Logstash setup (<code>logstash.setup</code>)<a class="headerlink" href="#logstash-setup-logstashsetup" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>Logstash parser setup processor.</p>
<p>This processor is used to create all the configuration
files required for the Logstash parser (e.g., input and filter configs).
Unless you provide a static Logstash parsing configuration you must
invoke this processor at somepoint during the pre-processing phase.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The processor only does the basic setup any Logstash parsing
filters used for processing specific log events must be prepared
separately.</p>
</div>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup logstash pipeline</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">logstash.setup</span><span class="w"></span>
<span class="w">  </span><span class="nt">context</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">var_files</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/servers.yaml</span><span class="w"></span>
<span class="w">  </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">servers</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.index_template_template">
<code class="highlight language-python"><span class="n">index_template_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.index_template_template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The template to use for the elasticsearch dataset index patterns index template</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_config_name">
<code class="highlight language-python"><span class="n">input_config_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_config_name" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The name of the log inputs config file. (relative to the pipeline config dir)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_template">
<code class="highlight language-python"><span class="n">input_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.input_template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The template to use for the file input plugin configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.legacy_index_template_template">
<code class="highlight language-python"><span class="n">legacy_index_template_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.legacy_index_template_template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The template to use for the elasticsearch dataset legacy index patterns index template</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.logstash_template">
<code class="highlight language-python"><span class="n">logstash_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.logstash_template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The template to use for the logstash configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_config_name">
<code class="highlight language-python"><span class="n">output_config_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_config_name" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The name of the log outputs config file. (relative to the pipeline config dir)</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_template">
<code class="highlight language-python"><span class="n">output_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.output_template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The template to use for the file output plugin configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.piplines_template">
<code class="highlight language-python"><span class="n">piplines_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.piplines_template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The template to use for the logstash pipelines configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_name">
<code class="highlight language-python"><span class="n">pre_process_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_name" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The file name to use for the pre process filters config. This is prefixed with 0000_ to ensure that the filters are run first.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_template">
<code class="highlight language-python"><span class="n">pre_process_template</span><span class="p">:</span> <span class="n">Path</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.pre_process_template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The template to use for the file output plugin configuration</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.servers">
<code class="highlight language-python"><span class="n">servers</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.servers" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Dictionary of servers and their log configurations</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.LogstashSetupProcessor.use_legacy_template">
<code class="highlight language-python"><span class="n">use_legacy_template</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.LogstashSetupProcessor.use_legacy_template" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>If the output config should use the legacy index template or the modern index template</p>
    </div>

  </div>









  </div>

    </div>

  </div>

<h2 id="data-flow-and-logic">Data Flow and Logic<a class="headerlink" href="#data-flow-and-logic" title="Permanent link">&para;</a></h2>
<h3 id="foreach-loop-foreach">ForEach Loop (<code>foreach</code>)<a class="headerlink" href="#foreach-loop-foreach" title="Permanent link">&para;</a></h3>


  <div class="doc doc-object doc-class">


    <div class="doc doc-contents first">

      <p>For each processor</p>
<p>This is a special processor container allowing for the
dynamic creation of a list of processor based on a list
of items.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Render labeling rules</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreach</span><span class="w"></span>
<span class="w">  </span><span class="c1"># processing/templates/rules</span><span class="w"></span>
<span class="w">  </span><span class="nt">items</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0_auth.yaml.j2</span><span class="w"></span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0_auth.yaml</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apache.yaml.j2</span><span class="w"></span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apache.yaml</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">audit.yaml.j2</span><span class="w"></span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">audit.yaml</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openvpn.yaml.j2</span><span class="w"></span>
<span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openvpn.yaml</span><span class="w"></span>
<span class="w">  </span><span class="nt">processor</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span><span class="w"></span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Rendering labeling rule {{ item.src }}</span><span class="w"></span>
<span class="w">    </span><span class="nt">template_context</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">var_files</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">attacker</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/attacker.yaml</span><span class="w"></span>
<span class="w">        </span><span class="nt">escalate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/escalate.yaml</span><span class="w"></span>
<span class="w">        </span><span class="nt">foothold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/attacker/foothold.yaml</span><span class="w"></span>
<span class="w">        </span><span class="nt">servers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">processing/config/servers.yaml</span><span class="w"></span>
<span class="w">    </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;processing/templates/rules/{{</span><span class="nv"> </span><span class="s">item.src</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;rules/{{</span><span class="nv"> </span><span class="s">item.dest</span><span class="nv"> </span><span class="s">}}&quot;</span><span class="w"></span>
</code></pre></div>




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.items">
<code class="highlight language-python"><span class="n">items</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.items" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>List of items to create processors for</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.loop_var">
<code class="highlight language-python"><span class="n">loop_var</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.loop_var" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The variable name to use for current loops item in the processor context</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="cr_kyoushi.dataset.processors.ForEachProcessor.processor">
<code class="highlight language-python"><span class="n">processor</span><span class="p">:</span> <span class="n">Any</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
      <small class="doc doc-property doc-property-required"><code>required</code></small>
  </span>

<a class="headerlink" href="#cr_kyoushi.dataset.processors.ForEachProcessor.processor" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>The processor template config to create multiple instances of</p>
    </div>

  </div>










  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../examples/process/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Dataset Processing
              </div>
            </div>
          </a>
        
        
          <a href="../rules/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Labeling Rules
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../js/jquery-3.5.1.min.js"></script>
      
        <script src="../js/jquery.fancybox.min.js"></script>
      
    
  </body>
</html>